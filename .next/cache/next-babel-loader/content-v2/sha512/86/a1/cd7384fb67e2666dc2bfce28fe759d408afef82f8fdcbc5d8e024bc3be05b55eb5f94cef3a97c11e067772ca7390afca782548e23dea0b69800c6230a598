{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"D:/MotichProduction/motich/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/MotichProduction/motich/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React, { useContext, useState, useEffect } from 'react';\nimport ContextApp from './../../context/App/ContextApp';\nimport { NET } from './../../network';\nimport cookie from 'react-cookies';\nimport { useRouter } from 'next/router';\nimport { createToken } from './../../context/App/actions';\n\nvar ProtectedOffice = function ProtectedOffice(_ref) {\n  var children = _ref.children;\n\n  var _useContext = useContext(ContextApp),\n      dispatchApp = _useContext.dispatchApp;\n\n  var router = useRouter();\n  var userToken = cookie.load('userToken');\n\n  var _useState = useState(null),\n      user = _useState[0],\n      setUser = _useState[1];\n\n  var dataSender = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              fetch(\"\".concat(NET.BACK_URL, \"/profile\"), {\n                method: 'POST',\n                headers: {\n                  'Accept': 'application/json',\n                  'Content-Type': 'application/json',\n                  'Authorization': \"Bearer \".concat(userToken)\n                }\n              }).then(function (response) {\n                if (response.status === 200) {\n                  response.json().then(function (data) {\n                    setUser(data);\n                    dispatchApp(createToken(data.user));\n                  });\n                } else if (response.status === 401) {\n                  router.push('/ru/auth/login');\n                }\n              });\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function dataSender() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  if (userToken) {\n    if (!user) {\n      dataSender();\n    } else {}\n  } else {\n    useEffect(function () {\n      router.push('/ru/auth/login');\n    }, []);\n  }\n\n  console.log(userToken);\n\n  if (!userToken) {\n    return null;\n  }\n\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: children\n  });\n};\n\nexport default ProtectedOffice;","map":null,"metadata":{},"sourceType":"module"}